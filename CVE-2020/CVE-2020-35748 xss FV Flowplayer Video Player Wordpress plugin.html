<html><head><meta content="text/html; charset=UTF-8" http-equiv="content-type"><style type="text/css">ul.lst-kix_h8kv1ne1mrmc-8{list-style-type:none}ul.lst-kix_h8kv1ne1mrmc-6{list-style-type:none}ul.lst-kix_h8kv1ne1mrmc-7{list-style-type:none}ul.lst-kix_h8kv1ne1mrmc-4{list-style-type:none}.lst-kix_h8kv1ne1mrmc-8>li:before{content:"-  "}ul.lst-kix_h8kv1ne1mrmc-5{list-style-type:none}ul.lst-kix_h8kv1ne1mrmc-2{list-style-type:none}.lst-kix_h8kv1ne1mrmc-7>li:before{content:"-  "}ul.lst-kix_h8kv1ne1mrmc-3{list-style-type:none}.lst-kix_h8kv1ne1mrmc-1>li:before{content:"-  "}.lst-kix_h8kv1ne1mrmc-2>li:before{content:"-  "}.lst-kix_h8kv1ne1mrmc-0>li:before{content:"-  "}.lst-kix_h8kv1ne1mrmc-4>li:before{content:"-  "}.lst-kix_h8kv1ne1mrmc-3>li:before{content:"-  "}ul.lst-kix_h8kv1ne1mrmc-0{list-style-type:none}.lst-kix_h8kv1ne1mrmc-6>li:before{content:"-  "}ul.lst-kix_h8kv1ne1mrmc-1{list-style-type:none}.lst-kix_h8kv1ne1mrmc-5>li:before{content:"-  "}ol{margin:0;padding:0}table td,table th{padding:0}.c5{padding-top:16pt;padding-bottom:4pt;line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}.c1{color:#000000;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:11pt;font-family:"Arial";font-style:normal}.c7{color:#000000;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:26pt;font-family:"Arial";font-style:normal}.c11{padding-top:0pt;padding-bottom:3pt;line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}.c4{color:#000000;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:10pt;font-family:"Arial";font-style:normal}.c6{color:#434343;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:14pt;font-family:"Arial";font-style:normal}.c9{padding-top:0pt;padding-bottom:0pt;line-height:1.0;orphans:2;widows:2;text-align:left}.c0{padding-top:0pt;padding-bottom:0pt;line-height:1.15;orphans:2;widows:2;text-align:left}.c3{background-color:#ffffff;max-width:451.4pt;padding:72pt 72pt 72pt 72pt}.c10{width:33%;height:1px}.c2{height:11pt}.c8{font-weight:700}.title{padding-top:0pt;color:#000000;font-size:26pt;padding-bottom:3pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}.subtitle{padding-top:0pt;color:#666666;font-size:15pt;padding-bottom:16pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}li{color:#000000;font-size:11pt;font-family:"Arial"}p{margin:0;color:#000000;font-size:11pt;font-family:"Arial"}h1{padding-top:20pt;color:#000000;font-size:20pt;padding-bottom:6pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}h2{padding-top:18pt;color:#000000;font-size:16pt;padding-bottom:6pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}h3{padding-top:16pt;color:#434343;font-size:14pt;padding-bottom:4pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}h4{padding-top:14pt;color:#666666;font-size:12pt;padding-bottom:4pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}h5{padding-top:12pt;color:#666666;font-size:11pt;padding-bottom:4pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}h6{padding-top:12pt;color:#666666;font-size:11pt;padding-bottom:4pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;font-style:italic;orphans:2;widows:2;text-align:left}</style></head><body class="c3"><p class="c11 title" id="h.x8tckpvt6ecw"><span class="c7">CVE-2020-35748</span></p><p class="c0 c2"><span class="c1"></span></p><p class="c0"><span class="c8">Author</span><span class="c1">: Arcangelo Saracino (github @arkango) (twitter @Arcange17622696)</span></p><p class="c0"><span class="c8">Company</span><span class="c1">: Hacktive Security Srl</span></p><p class="c0 c2"><span class="c1"></span></p><p class="c0 c2"><span class="c1"></span></p><p class="c0"><span class="c1">During one of our research activities we discovered an authenticated stored cross site scripting in the FV Flowplayer Video Player Wordpress plugin.</span></p><p class="c0 c2"><span class="c1"></span></p><p class="c0"><span>The FV Flowplayer Video Player Wordpress plugin boasts over 40,000 active installations and an excellent reputation in terms of reviews, easy-to-use, and complete solution for embedding FLV or MP4 videos into posts or pages.</span><sup><a href="#ftnt1" id="ftnt_ref1">[1]</a></sup></p><p class="c0 c2"><span class="c1"></span></p><p class="c0"><span class="c1">Cross site scripting (XSS) is a common attack vector that injects client-side malicious code into a vulnerable web application. XSS differs from other web attack vectors (e.g., SQL injections), in that it does not directly target the application itself. Instead, the users of the web application are the ones at risk.</span></p><p class="c0"><span class="c1">Stored cross-site scripting (also known as second-order or persistent XSS) arises when an application receives data from an untrusted source and includes that data within its later HTTP responses in an unsafe way.</span></p><p class="c0"><span class="c1">An attacker able to exploit an xss can create a phishing scenario through a fake login page and retrieve valid credentials, extraction of cookies not protected by the `HttpOnly` flag and consequent exfiltration of a valid session, simple defacement.</span></p><p class="c0 c2"><span class="c1"></span></p><p class="c0 c2"><span class="c1"></span></p><p class="c0"><span class="c1">Tested on: </span></p><p class="c0"><span class="c1">&nbsp; &nbsp; &nbsp; -&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;V7.4.37.727 (latest)</span></p><p class="c0 c2"><span class="c1"></span></p><p class="c0 c2"><span class="c1"></span></p><h3 class="c5" id="h.6tir1g7nfe8x"><span class="c6">Authenticated Stored Cross Site Scripting</span></h3><p class="c0 c2"><span class="c1"></span></p><p class="c0"><span class="c1">The FV Flowplayer Video Player Wordpress plugin allows you to embed FLV or MP4 videos into posts or pages.</span></p><p class="c0 c2"><span class="c1"></span></p><p class="c0"><span class="c1">It receives two inputs:</span></p><p class="c0"><span class="c1">- a video source </span></p><p class="c0"><span class="c1">- a cover image.</span></p><p class="c0 c2"><span class="c1"></span></p><p class="c0 c2"><span class="c1"></span></p><p class="c0"><span class="c1">In the video source parameter an attacker can be able to inject JavaScript code in order to execute a Stored Cross-Site Scripting.</span></p><p class="c0 c2"><span class="c1"></span></p><p class="c0"><span class="c1">The POST request to create/update the videoplayer contains the `data` parameter, which contains a json string and the vulnerable field fv_wp_fvvideoplayer_src to the injection.</span></p><p class="c0 c2"><span class="c1"></span></p><p class="c0"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 601.70px; height: 258.67px;"><img alt="" src="images/image4.png" style="width: 601.70px; height: 258.67px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c0"><span class="c1">Function used to save the field, without escaping or check.</span></p><p class="c0 c2"><span class="c1"></span></p><p class="c0 c2"><span class="c1"></span></p><p class="c0 c2"><span class="c1"></span></p><p class="c0"><span>&nbsp;So we can confirm from the github source code</span><sup><a href="#ftnt2" id="ftnt_ref2">[2]</a></sup><span class="c1">&nbsp;the vulnerability still exists.</span></p><p class="c0"><span style="overflow: hidden; display: inline-block; margin: 0.00px -0.00px; border: 1.33px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 601.70px; height: 326.67px;"><img alt="" src="images/image3.png" style="width: 601.70px; height: 326.67px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c0 c2"><span class="c1"></span></p><p class="c0 c2"><span class="c1"></span></p><p class="c0"><span class="c1">Now we show how an attacker could be able to trigger the vulnerability from the wordpress frontend.</span></p><p class="c0 c2"><span class="c1"></span></p><p class="c0"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 601.70px; height: 241.33px;"><img alt="" src="images/image1.png" style="width: 601.70px; height: 241.33px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c0 c2"><span class="c1"></span></p><p class="c0"><span class="c1">Payload execution after the video player has been saved.</span></p><p class="c0 c2"><span class="c1"></span></p><p class="c0"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 601.70px; height: 237.33px;"><img alt="" src="images/image2.png" style="width: 601.70px; height: 237.33px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c0 c2"><span class="c1"></span></p><hr class="c10"><div><p class="c9"><a href="#ftnt_ref1" id="ftnt1">[1]</a><span class="c4">&nbsp;https://wordpress.org/plugins/fv-wordpress-flowplayer/</span></p></div><div><p class="c9"><a href="#ftnt_ref2" id="ftnt2">[2]</a><span class="c4">&nbsp;https://github.com/foliovision/fv-wordpress-flowplayer</span></p></div></body></html>
