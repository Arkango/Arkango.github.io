<html><head><meta content="text/html; charset=UTF-8" http-equiv="content-type"><style type="text/css">ul.lst-kix_h8kv1ne1mrmc-8{list-style-type:none}ul.lst-kix_h8kv1ne1mrmc-6{list-style-type:none}ul.lst-kix_h8kv1ne1mrmc-7{list-style-type:none}ul.lst-kix_h8kv1ne1mrmc-4{list-style-type:none}.lst-kix_h8kv1ne1mrmc-8>li:before{content:"-  "}ul.lst-kix_h8kv1ne1mrmc-5{list-style-type:none}ul.lst-kix_h8kv1ne1mrmc-2{list-style-type:none}.lst-kix_h8kv1ne1mrmc-7>li:before{content:"-  "}ul.lst-kix_h8kv1ne1mrmc-3{list-style-type:none}li.li-bullet-0:before{margin-left:-18pt;white-space:nowrap;display:inline-block;min-width:18pt}.lst-kix_h8kv1ne1mrmc-1>li:before{content:"-  "}.lst-kix_h8kv1ne1mrmc-2>li:before{content:"-  "}.lst-kix_h8kv1ne1mrmc-0>li:before{content:"-  "}.lst-kix_h8kv1ne1mrmc-4>li:before{content:"-  "}.lst-kix_h8kv1ne1mrmc-3>li:before{content:"-  "}ul.lst-kix_h8kv1ne1mrmc-0{list-style-type:none}.lst-kix_h8kv1ne1mrmc-6>li:before{content:"-  "}ul.lst-kix_h8kv1ne1mrmc-1{list-style-type:none}.lst-kix_h8kv1ne1mrmc-5>li:before{content:"-  "}ol{margin:0;padding:0}table td,table th{padding:0}.c0{padding-top:0pt;padding-bottom:0pt;line-height:1.15;orphans:2;widows:2;text-align:left;height:11pt}.c14{color:#000000;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:26pt;font-family:"Arial";font-style:normal}.c3{color:#000000;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:11pt;font-family:"Arial";font-style:normal}.c5{color:#000000;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:10pt;font-family:"Arial";font-style:normal}.c6{padding-top:16pt;padding-bottom:4pt;line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}.c8{padding-top:0pt;padding-bottom:3pt;line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}.c1{color:#434343;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:14pt;font-family:"Arial";font-style:normal}.c2{padding-top:0pt;padding-bottom:0pt;line-height:1.15;orphans:2;widows:2;text-align:left}.c12{padding-top:0pt;padding-bottom:0pt;line-height:1.15;orphans:2;widows:2;text-align:justify}.c4{padding-top:0pt;padding-bottom:0pt;line-height:1.0;orphans:2;widows:2;text-align:left}.c7{background-color:#ffffff;max-width:451.4pt;padding:72pt 72pt 72pt 72pt}.c16{padding:0;margin:0}.c13{width:33%;height:1px}.c10{margin-left:36pt;padding-left:0pt}.c9{font-weight:700}.c11{background-color:#d9d9d9}.c15{height:11pt}.title{padding-top:0pt;color:#000000;font-size:26pt;padding-bottom:3pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}.subtitle{padding-top:0pt;color:#666666;font-size:15pt;padding-bottom:16pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}li{color:#000000;font-size:11pt;font-family:"Arial"}p{margin:0;color:#000000;font-size:11pt;font-family:"Arial"}h1{padding-top:20pt;color:#000000;font-size:20pt;padding-bottom:6pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}h2{padding-top:18pt;color:#000000;font-size:16pt;padding-bottom:6pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}h3{padding-top:16pt;color:#434343;font-size:14pt;padding-bottom:4pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}h4{padding-top:14pt;color:#666666;font-size:12pt;padding-bottom:4pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}h5{padding-top:12pt;color:#666666;font-size:11pt;padding-bottom:4pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}h6{padding-top:12pt;color:#666666;font-size:11pt;padding-bottom:4pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;font-style:italic;orphans:2;widows:2;text-align:left}</style></head><body class="c7"><p class="c8 title" id="h.x8tckpvt6ecw"><span class="c14">CVE-2020-35749</span></p><p class="c0"><span class="c3"></span></p><p class="c2"><span class="c9">Author</span><span class="c3">: Arcangelo Saracino (github @arkango) (twitter @Arcange17622696)</span></p><p class="c2"><span class="c9">Company</span><span class="c3">: Hacktive Security Srl</span></p><p class="c0"><span class="c3"></span></p><p class="c2"><span class="c3">During one of our research activities we discovered an authenticated local inclusion in the Simple Board Job Wordpress plugin.</span></p><p class="c0"><span class="c3"></span></p><p class="c2"><span>The Simple Board Joab wordpress plugin boasts over 20,000 active installations and an excellent reputation in terms of reviews, allowing the simple and efficient management of job offers.</span><sup><a href="#ftnt1" id="ftnt_ref1">[1]</a></sup></p><p class="c0"><span class="c3"></span></p><p class="c12"><span class="c3">Directory traversal allows an attacker to step out of the root directory and access other parts of the file system. This might give the attacker the ability to view restricted files, which could provide the attacker with more information required to further compromise the system (download source code files).</span></p><p class="c12 c15"><span class="c3"></span></p><p class="c0"><span class="c3"></span></p><p class="c0"><span class="c3"></span></p><p class="c2"><span class="c3">Tested on: </span></p><p class="c2"><span class="c3">&nbsp; &nbsp; &nbsp; -&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;V2.9.3 (latest)</span></p><ul class="c16 lst-kix_h8kv1ne1mrmc-0 start"><li class="c2 c10 li-bullet-0"><span class="c3">V2.8.82 - PHP 7.2.21</span></li></ul><p class="c0"><span class="c3"></span></p><p class="c2"><span class="c3">Working on version &gt; 2.4.3</span></p><p class="c0"><span class="c3"></span></p><h3 class="c6" id="h.6tir1g7nfe8x"><span class="c1">Authenticated Directory Traversal</span></h3><p class="c0"><span class="c3"></span></p><p class="c2"><span class="c3">The Simple Job Board plugin allows you to receive a candidate&#39;s resume for a job offer.</span></p><p class="c0"><span class="c3"></span></p><p class="c2"><span class="c3">To Each candidate is assigned an application number and the resume is made accessible to an HR user through the following link </span></p><p class="c0"><span class="c3"></span></p><p class="c2"><span class="c5 c11">`https://localhost/wp-admin/post.php?post=application_id&amp;action=edit&amp;resume=application_id`</span></p><p class="c0"><span class="c3"></span></p><p class="c2"><span>Or with the paid component `Multiple Attachment Fields Add on`</span><sup><a href="#ftnt2" id="ftnt_ref2">[2]</a></sup></p><p class="c0"><span class="c3"></span></p><p class="c2"><span class="c5 c11">`https://localhost/wp-admin/post.php?post=application_id&amp;action=edit&amp;sjb_file=application_id_filename.pdf`</span></p><p class="c0"><span class="c3"></span></p><p class="c2"><span class="c3">Looking for some references of the parameter in the code, we found that the&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></p><p class="c0"><span class="c3"></span></p><p class="c2"><span class="c3">File : simple-job-board/includes/class-simple_job_board_resume_download_handler.php</span></p><p class="c0"><span class="c3"></span></p><p class="c0"><span class="c3"></span></p><p class="c2"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 601.70px; height: 572.00px;"><img alt="" src="images/image2.png" style="width: 601.70px; height: 572.00px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c2"><span class="c3">Code Snippet.</span></p><p class="c0"><span class="c3"></span></p><p class="c2"><span>Following the field $_GET[&lsquo;sjb_file&rsquo;] it is never sanitized, the esc_attr() function execute only an html encoding </span><sup><a href="#ftnt3" id="ftnt_ref3">[3]</a></sup><span class="c3">.</span></p><p class="c0"><span class="c3"></span></p><p class="c2"><span class="c3">So the $filepath variable at the end contains </span></p><p class="c2"><span class="c3">$files[&lsquo;basedir] (&lsquo;/var/www/html/wp-content/uploads/jobpost/2020&rsquo;) &nbsp;and</span></p><p class="c2"><span class="c3">$_GET[&lsquo;sjb_file&rsquo;] (filename)</span></p><p class="c0"><span class="c3"></span></p><p class="c2"><span class="c3">After the basename check an header(&lsquo;Location &rsquo;.$filepath) is executed, so we can exploit this.</span></p><p class="c0"><span class="c3"></span></p><p class="c0"><span class="c3"></span></p><p class="c2"><span class="c3">The upload location for the resume is :</span></p><p class="c0"><span class="c3"></span></p><p class="c2"><span class="c3">`/wp-content/uploads/jobpost/2020/application_id_resume.pdf`</span></p><p class="c0"><span class="c3"></span></p><p class="c2"><span class="c3">So the following link show how the directory traversal can be exploited going back to the folders:</span></p><p class="c0"><span class="c3"></span></p><p class="c2"><span class="c5 c11">`https://localhost/wp-admin/post.php?post=application_id&amp;action=edit&amp;sjb_file=../../../../wp-config.php`</span></p><p class="c0"><span class="c3"></span></p><p class="c2"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 601.70px; height: 76.00px;"><img alt="" src="images/image1.png" style="width: 601.70px; height: 76.00px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><hr class="c13"><div><p class="c4"><a href="#ftnt_ref1" id="ftnt1">[1]</a><span class="c5">&nbsp;https://wordpress.org/plugins/simple-job-board/</span></p></div><div><p class="c4"><a href="#ftnt_ref2" id="ftnt2">[2]</a><span class="c5">&nbsp;https://market.presstigers.com/product/multiple-attachment-fields-add-on/</span></p></div><div><p class="c4"><a href="#ftnt_ref3" id="ftnt3">[3]</a><span class="c5">&nbsp;https://developer.wordpress.org/reference/functions/esc_attr/</span></p></div></body></html>
